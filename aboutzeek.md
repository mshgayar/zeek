# About Zeek : 

Zeek is an
open-source network monitoring platform that provides in-depth traffic analysis, which is
particularly valuable for detecting network anomalies and security incidents. Zeek’s role in network security is to monitor network traffic in real time, analyze network events, and generate logs that can be used for security analysis, forensic investigations, and threat detection.

Zeek operates by passively
monitoring network traffic, where it dissects packets, analyzes protocol behavior, and generates events that describe the activities occurring in the network. Zeek provides detailed logs on various network events like HTTP requests, DNS queries, and SSL/TLS handshakes, allowing security teams to monitor and investigate potential threats.

## Zeek logs
Zeek logs are a collection of files generated by Zeek (formerly known as Bro), a powerful network security monitoring (NSM) tool. These logs provide detailed information about network traffic, security events, and other behaviors on a network. Zeek uses various scripting capabilities to analyze network traffic in real-time and generate logs for different types of network activities. The logs generated by Zeek are crucial for understanding network events, detecting anomalies, and performing post-event analysis.

**Common Types of Zeek Logs:**

* conn.log: Contains information about network connections, such as source/destination IP addresses, ports, protocols, and connection durations.
* Logs HTTP transactions, including request details, response status codes, and other HTTP-related metadata.
* Captures DNS query and response data, including the queried domain names and response types.
* ssl.log: Logs information about SSL/TLS sessions, such as certificates, handshake details, and cipher suites.
* Records information about files transmitted over the network, including file names, file sizes, and hash values.
* notice.log: Logs significant security-related events or anomalies detected by Zeek scripts, such as intrusion detection alerts or suspicious behavior.
* dhcp.log: Records DHCP transactions, which can help identify devices on the network and the IP addresses they have been assigned.
* smtp.log: Logs email traffic over the SMTP protocol, capturing details about email conversations.
* ftp.log: Logs FTP sessions, including file transfers and commands executed during FTP sessions.
* weird.log: Captures unusual or potentially suspicious behavior detected by Zeek, such as unexpected protocol usage or malformed packets.

**Zeek Log Features:** 

* Format: By default, Zeek logs are stored in a custom format with tab-separated values (TSV), making them easy to process with tools like awk, grep, and jq for further analysis.
* Forwarding: Zeek logs can be forwarded to external systems like SIEMs (Security Information and Event Management systems), including Splunk, for centralized analysis and visualization.
* Log Rotation: Zeek supports log rotation, which can be configured to manage the size and frequency of log file generation.

## Zeek Vs Suricata
![alt text](https://github.com/mshgayar/zeek/blob/main/ZeekVsSuricata.png)

### Functional Differences
![alt text](https://github.com/mshgayar/zeek/blob/main/Functional%20differences.png)

### Zeek Strengths
*  Deep Traffic Analysis: Provides detailed logs on network activity (e.g., HTTP, DNS, SSL/TLS, SMB, etc.).
*  Anomaly Detection: Uses behavioral-based detection rather than traditional signatures.
*  Scripting Engine: Users can write custom Zeek scripts for threat hunting and analysis.
*  Forensic Capabilities: Ideal for post-incident investigation and NSM.
*  Efficient Log Generation: Provides structured logs that can be forwarded to SIEMs like Splunk or Elasticsearch.

### Suricata Strengths
* High-Speed Signature Matching: Uses multi-threaded processing for rule-based detection.
* IPS Mode: Can be deployed inline to block malicious traffic in real-time.
* PCAP Logging & File Extraction: Supports capturing and extracting files from network traffic.
* Integration with SIEMs: Outputs alerts in JSON format (eve.json) for easy integration with security tools.
* Deep Packet Inspection (DPI): Can inspect packet payloads and protocols at a deep level.

--
### Deployment sceanrios
![alt text](https://github.com/mshgayar/zeek/blob/main/Deployment%20Scenario.png)


### When to use Zeek VS Suricata
![alt text](https://github.com/mshgayar/zeek/blob/main/Use%20cases.png)

----
### Can Zeek and Suricata Work Together?
**Yes! Zeek and Suricata complement each other. A common architecture includes:**

* Zeek for NSM & behavioral analysis (logs all network activity, allows for deep investigation).
* Suricata for IDS/IPS (detects & alerts on known threats using signatures).
* Logs from both tools can be forwarded to Splunk, ELK, or a SIEM for centralized analysis.

**Example Setup:**

* Zeek logs all network activity (conn.log, http.log, ssl.log, etc.).
* Suricata generates real-time alerts when a known threat is detected.
* SIEM correlates Zeek & Suricata data for full security visibility.

**Final Thoughts** 

* If you want deep network traffic visibility & forensic capabilities → Use Zeek.
* If you need real-time detection & prevention using known threat signatures → Use Suricata.
* For the best security coverage, deploy both tools together.
